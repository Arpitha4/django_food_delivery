{% load static %}
<html>
<head>
  <meta charset="UTF-8">
  <title>Signup - Verify OTP</title>
  <link rel="stylesheet" href="{% static 'css/verify_otp.css' %}">
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="{% static 'js/verify_otp.js' %}"></script>
</head>
<body>
<div class="login-container">
  <h2>Signup - Verify OTP</h2>
  <p>Mobile: {{ mobile }}</p>

  {% if error %}
    <p class="error-message">{{ error }}</p>
  {% endif %}

  <form method="post" id="otpForm">
    {% csrf_token %}
    <input type="hidden" name="mobile" value="{{ mobile }}">

    <label for="role">Select User Type:</label>
    <select name="role" id="role" required>
      <option value="customer">Customer</option>
      <option value="delivery">Delivery Partner</option>
      <option value="admin">Admin</option>
    </select>

    <div id="access_key_div" style="display:none; margin-top:10px;">
      <input type="text" name="access_key" placeholder="Enter Access Key">
    </div>

    <input type="text" name="otp" id="otp" placeholder="Enter OTP" required>
    <button type="submit" name="verify_otp">Signup/Login</button>
  </form>
</div>

<script>
  $(document).ready(function(){
    $('#role').on('change', function(){
      const val = $(this).val();
      if(val === 'admin' || val === 'delivery'){
        $('#access_key_div').show();
      }else{
        $('#access_key_div').hide();
      }
    });

    // Trigger change on page load to handle pre-selected value
    $('#role').trigger('change');
  });
</script>
</body>
</html>
